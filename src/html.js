export var HTML_TEMPLATE = '<!DOCTYPE html>\n<html lang="id">\n<head>\n<meta charset="UTF-8">\n<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5">\n<title>Harga Emas Treasury</title>\n<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"/>\n<style>\n*{box-sizing:border-box}\nbody{font-family:Arial,sans-serif;margin:0;padding:5px 20px 0 20px;background:#fff;color:#222;transition:background .3s,color .3s}\nh2{margin:0 0 2px}\nh3{margin:20px 0 10px}\n.header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:2px}\n.title-wrap{display:flex;align-items:center;gap:10px}\n.tele-link{display:inline-flex;align-items:center;gap:6px;text-decoration:none;transition:transform .2s}\n.tele-link:hover{transform:scale(1.05)}\n.tele-icon{display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;background:#0088cc;color:#fff;border-radius:50%;transition:background .3s}\n.tele-link:hover .tele-icon{background:#006699}\n.tele-text{font-size:0.95em;font-weight:bold;color:#ff1744}\n.dark-mode .tele-icon{background:#29b6f6}\n.dark-mode .tele-link:hover .tele-icon{background:#0288d1}\n.dark-mode .tele-text{color:#00E124}\n#jam{font-size:2em;color:#ff1744;font-weight:bold;margin-bottom:8px}\ntable.dataTable{width:100%!important;border-collapse:collapse}\ntable.dataTable thead th{font-weight:bold;white-space:nowrap;padding:10px 8px;font-size:1em;border-bottom:2px solid #ddd}\ntable.dataTable tbody td{padding:8px 6px;white-space:nowrap;border-bottom:1px solid #eee;font-size:1em}\nth.waktu,td.waktu{width:78px;min-width:72px;max-width:82px;text-align:center;padding-left:2px!important;padding-right:2px!important}\nth.transaksi,td.transaksi{text-align:left;min-width:220px}\nth.profit,td.profit{width:155px;min-width:145px;max-width:165px;text-align:left;padding-left:8px!important;padding-right:8px!important}\n.theme-toggle-btn{padding:0;border:none;border-radius:50%;background:#222;color:#fff;cursor:pointer;font-size:1.5em;width:44px;height:44px;display:flex;align-items:center;justify-content:center;transition:background .3s}\n.theme-toggle-btn:hover{background:#444}\n.dark-mode{background:#181a1b!important;color:#e0e0e0!important}\n.dark-mode #jam{color:#ffb300!important}\n.dark-mode table.dataTable,.dark-mode table.dataTable thead th{background:#23272b!important;color:#e0e0e0!important}\n.dark-mode table.dataTable tbody td{background:#23272b;color:#e0e0e0!important;border-bottom:1px solid #333}\n.dark-mode table.dataTable thead th{color:#ffb300!important;border-bottom:2px solid #444}\n.dark-mode .theme-toggle-btn{background:#ffb300;color:#222}\n.dark-mode .theme-toggle-btn:hover{background:#ffd54f}\n.container-flex{display:flex;gap:15px;flex-wrap:wrap;margin-top:10px}\n.card{border:1px solid #ccc;border-radius:6px;padding:10px}\n.card-usd{width:248px;height:370px;overflow-y:auto}\n.card-chart{flex:1;min-width:400px;height:370px;overflow:hidden}\n#priceList{list-style:none;padding:0;margin:0;max-height:275px;overflow-y:auto}\n#priceList li{margin-bottom:1px}\n.time{color:gray;font-size:.9em;margin-left:10px}\n#currentPrice{color:red;font-weight:bold}\n.dark-mode #currentPrice{color:#00E124;text-shadow:1px 1px #00B31C}\n#tabel tbody tr:first-child td{color:red!important;font-weight:bold}\n.dark-mode #tabel tbody tr:first-child td{color:#00E124!important}\n#footerApp{width:100%;position:fixed;bottom:0;left:0;background:transparent;text-align:center;z-index:100;padding:8px 0}\n.marquee-text{display:inline-block;color:#F5274D;animation:marquee 70s linear infinite;font-weight:bold}\n.dark-mode .marquee-text{color:#B232B2}\n@keyframes marquee{0%{transform:translateX(100vw)}100%{transform:translateX(-100%)}}\n.loading-text{color:#999;font-style:italic}\n.tbl-wrap{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}\n.dataTables_wrapper{position:relative}\n.dt-top-controls{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;margin-bottom:0!important;padding:8px 0;padding-bottom:0!important}\n.dataTables_wrapper .dataTables_length{margin:0!important;float:none!important;margin-bottom:0!important;padding-bottom:0!important}\n.dataTables_wrapper .dataTables_filter{margin:0!important;float:none!important}\n.dataTables_wrapper .dataTables_info{display:none!important}\n.dataTables_wrapper .dataTables_paginate{margin-top:10px!important;text-align:center!important}\n.tbl-wrap{margin-top:0!important;padding-top:0!important}\n#tabel.dataTable{margin-top:0!important}\n#tabel tbody td.transaksi{padding:6px 8px;white-space:nowrap}\n.profit-order-btns{display:none;gap:3px;align-items:center;margin-right:6px}\n.profit-btn{padding:5px 10px;border:1px solid #aaa;background:#f0f0f0;border-radius:4px;font-size:12px;cursor:pointer;font-weight:bold;transition:all .2s}\n.profit-btn:hover{background:#ddd}\n.profit-btn.active{background:#007bff;color:#fff;border-color:#007bff}\n.dark-mode .profit-btn{background:#333;border-color:#555;color:#ccc}\n.dark-mode .profit-btn:hover{background:#444}\n.dark-mode .profit-btn.active{background:#ffb300;color:#222;border-color:#ffb300}\n.filter-wrap{display:flex;align-items:center}\n.tradingview-wrapper{height:100%;width:100%;overflow:hidden}\n.chart-header{display:flex;justify-content:space-between;align-items:center;margin-top:0;margin-bottom:10px}\n.chart-header h3{margin:0}\n.limit-label{font-size:0.95em;font-weight:bold;color:#ff1744}\n.limit-label .limit-num{font-size:1.1em;padding:2px 8px;background:#ff1744;color:#fff;border-radius:4px;margin-left:4px}\n.dark-mode .limit-label{color:#00E124}\n.dark-mode .limit-label .limit-num{background:#00E124;color:#181a1b}\n.dark-mode .card{border-color:#444}\n#tabel thead th.waktu,#tabel tbody td.waktu{position:sticky;left:0;z-index:2;background:#fff}\n#tabel thead th.waktu{z-index:3}\n.dark-mode #tabel thead th.waktu{background:#23272b}\n.dark-mode #tabel tbody td.waktu{background:#23272b}\n@keyframes blink-yellow{0%,100%{background-color:#fff}50%{background-color:#ffeb3b}}\n@keyframes blink-yellow-dark{0%,100%{background-color:#23272b}50%{background-color:#ffd600}}\n#tabel tbody tr.blink-row td.waktu{animation:blink-yellow 0.4s ease-in-out 5}\n.dark-mode #tabel tbody tr.blink-row td.waktu{animation:blink-yellow-dark 0.4s ease-in-out 5}\n.bottom-section{display:flex;flex-direction:row;gap:20px;margin-top:20px;margin-bottom:60px;align-items:flex-start}\n.calendar-box{flex:1;min-width:0}\n.calendar-box h3{margin:0 0 10px;font-size:1.1em;display:flex;align-items:center;gap:8px}\n.card-calendar{border:1px solid #ccc;border-radius:6px;padding:10px;height:520px;overflow:hidden}\n.dark-mode .card-calendar{border-color:#444;background:#23272b}\n.calendar-scroll-wrapper{width:100%;height:calc(100% - 30px);overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch}\n.calendar-scroll-wrapper iframe{min-width:650px;width:100%;height:100%;border:none}\n.calendar-credit{font-family:Arial,Helvetica,sans-serif;font-size:11px;color:#333;margin-top:8px;text-align:center}\n.calendar-credit a{color:#06529D;font-weight:bold;text-decoration:none}\n.calendar-credit a:hover{text-decoration:underline}\n.dark-mode .calendar-credit{color:#aaa}\n.dark-mode .calendar-credit a{color:#ffb300}\n.calc-box{width:300px;flex-shrink:0}\n.calc-box h3{margin:0 0 10px;font-size:1.1em}\n.calc-cards{display:flex;flex-direction:column;gap:12px}\n.card-calc{border:1px solid #ccc;border-radius:6px;padding:14px;background:#fff}\n.dark-mode .card-calc{border-color:#444;background:#23272b}\n.card-calc h4{margin:0 0 10px;font-size:1em;display:flex;align-items:center;gap:6px;color:#333}\n.dark-mode .card-calc h4{color:#e0e0e0}\n.calc-rate{font-size:0.9em;color:#666;margin:0 0 12px;padding:8px 10px;background:#f5f5f5;border-radius:4px;font-weight:500}\n.calc-rate span{font-weight:bold;color:#ff1744}\n.dark-mode .calc-rate{background:#2a2e32;color:#aaa}\n.dark-mode .calc-rate span{color:#00E124}\n.calc-input-group{margin-bottom:12px}\n.calc-input-group:last-child{margin-bottom:0}\n.calc-input-group label{display:block;font-size:0.85em;margin-bottom:5px;color:#555;font-weight:500}\n.dark-mode .calc-input-group label{color:#aaa}\n.calc-input-group input{width:100%;padding:12px;border:2px solid #ddd;border-radius:6px;font-size:1em;transition:border-color .2s,box-shadow .2s}\n.calc-input-group input:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 3px rgba(0,123,255,0.15)}\n.dark-mode .calc-input-group input{background:#1e2124;border-color:#444;color:#e0e0e0}\n.dark-mode .calc-input-group input:focus{border-color:#ffb300;box-shadow:0 0 0 3px rgba(255,179,0,0.15)}\n.calc-input-group input::placeholder{color:#999}\n.dark-mode .calc-input-group input::placeholder{color:#666}\n@media(min-width:768px) and (max-width:1024px){body{padding:15px;padding-bottom:50px}h2{font-size:1.15em}h3{font-size:1.05em;margin:15px 0 8px}.header{margin-bottom:4px}.tele-icon{width:30px;height:30px}.tele-icon svg{width:16px;height:16px}.tele-text{font-size:0.9em}#jam{font-size:2em;margin-bottom:8px}.theme-toggle-btn{width:42px;height:42px;font-size:1.4em}.container-flex{flex-direction:row;gap:15px}.card-usd{width:220px;height:350px}.card-chart{flex:1;min-width:350px;height:350px}.profit-order-btns{display:flex}.profit-btn{padding:6px 12px;font-size:13px}.bottom-section{flex-direction:row;gap:15px}.calc-box{width:280px}.card-calendar{height:500px}}\n@media(min-width:576px) and (max-width:767px){body{padding:12px;padding-bottom:50px}.container-flex{flex-direction:column;gap:15px}.card-usd,.card-chart{width:100%!important;max-width:100%!important;min-width:0!important}.card-usd{height:auto;min-height:300px}.card-chart{height:360px}.profit-order-btns{display:flex}.bottom-section{flex-direction:column;gap:18px;margin-bottom:55px}.calc-box{width:100%}.calc-cards{flex-direction:row;gap:12px}.calc-cards .card-calc{flex:1}}\n@media(min-width:480px) and (max-width:575px){body{padding:10px;padding-bottom:48px}.container-flex{flex-direction:column;gap:12px}.card-usd,.card-chart{width:100%!important;max-width:100%!important;min-width:0!important}.card-usd{height:auto;min-height:280px}.card-chart{height:340px}.profit-order-btns{display:flex}.bottom-section{flex-direction:column;gap:15px;margin-bottom:50px}.calc-box{width:100%}.calc-cards{flex-direction:row;gap:10px}.calc-cards .card-calc{flex:1}}\n@media(max-width:479px){body{padding:8px;padding-bottom:45px}.container-flex{flex-direction:column;gap:10px}.card-usd,.card-chart{width:100%!important;max-width:100%!important;min-width:0!important}.card-usd{height:auto;min-height:260px}.card-chart{height:300px}.profit-order-btns{display:flex}.bottom-section{flex-direction:column;gap:15px;margin-bottom:48px}.calc-box{width:100%}.calc-cards{flex-direction:column;gap:10px}.calc-cards .card-calc{width:100%}}\n</style>\n</head>\n<body>\n<div class="header">\n<div class="title-wrap">\n<h2>Harga Emas Treasury  \\u27BA </h2>\n<a href="https://t.me/+FLtJjyjVV8xlM2E1" target="_blank" class="tele-link" title="Join Telegram"><span class="tele-icon"><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg></span><span class="tele-text">Telegram</span></a>\n</div>\n<button class="theme-toggle-btn" id="themeBtn" onclick="toggleTheme()" title="Ganti Tema">\\u{1F319}</button>\n</div>\n<div id="jam"></div>\n<div class="tbl-wrap">\n<table id="tabel" class="display">\n<thead>\n<tr>\n<th class="waktu">Waktu</th>\n<th class="transaksi">Data Transaksi</th>\n<th class="profit" id="thP1">Est.cuan 10JT \\u27BA gr</th>\n<th class="profit" id="thP2">Est.cuan 20JT \\u27BA gr</th>\n<th class="profit" id="thP3">Est.cuan 30JT \\u27BA gr</th>\n<th class="profit" id="thP4">Est.cuan 40JT \\u27BA gr</th>\n<th class="profit" id="thP5">Est.cuan 50JT \\u27BA gr</th>\n</tr>\n</thead>\n<tbody></tbody>\n</table>\n</div>\n<div class="container-flex">\n<div style="flex:1;min-width:400px">\n<div class="chart-header">\n<h3>Chart Harga Emas (XAU/USD)</h3>\n<span class="limit-label">Limit Bulan ini:<span class="limit-num" id="limitBulan">88888</span></span>\n</div>\n<div class="card card-chart">\n<div class="tradingview-wrapper" id="tradingview_chart"></div>\n</div>\n</div>\n<div>\n<h3 style="margin-top:0">Harga USD/IDR Google Finance</h3>\n<div class="card card-usd">\n<p>Harga saat ini: <span id="currentPrice" class="loading-text">Memuat data...</span></p>\n<h4>Harga Terakhir:</h4>\n<ul id="priceList"><li class="loading-text">Menunggu data...</li></ul>\n</div>\n</div>\n</div>\n<div class="bottom-section">\n<div class="calendar-box">\n<h3>\\u{1F4C5} Kalender Ekonomi</h3>\n<div class="card card-calendar">\n<div class="calendar-scroll-wrapper">\n<iframe src="https://sslecal2.investing.com?columns=exc_flags,exc_currency,exc_importance,exc_actual,exc_forecast,exc_previous&category=_employment,_economicActivity,_inflation,_credit,_centralBanks,_confidenceIndex,_balance,_Bonds&importance=3&features=datepicker,timezone,timeselector,filters&countries=5,25,37,48,4,35,17,22,12,72&calType=week&timeZone=27&lang=54" allowtransparency="true" marginwidth="0" marginheight="0"></iframe>\n</div>\n<div class="calendar-credit">\n<span>Kalender Ekonomi Real Time dipersembahkan oleh <a href="https://id.investing.com" rel="nofollow" target="_blank">Investing.com Indonesia</a>.</span>\n</div>\n</div>\n</div>\n<div class="calc-box">\n<h3>\\u{1F9EE} Kalkulator Emas</h3>\n<div class="calc-cards">\n<div class="card-calc">\n<h4>\\u{1F4B0} Hitung Beli</h4>\n<p class="calc-rate">Harga: <span id="buyRateDisplay">-</span>/gr</p>\n<div class="calc-input-group">\n<label>Masukkan Rupiah (IDR)</label>\n<input type="text" id="buyIdr" inputmode="numeric" placeholder="Contoh: 88.000.000">\n</div>\n<div class="calc-input-group">\n<label>Gram \\u21C6</label>\n<input type="text" id="buyGram" inputmode="decimal" placeholder="isi gram, contoh: 0.8888">\n</div>\n</div>\n<div class="card-calc">\n<h4>\\u{1F4B8} Hitung Jual</h4>\n<p class="calc-rate">Harga: <span id="sellRateDisplay">-</span>/gr</p>\n<div class="calc-input-group">\n<label>Masukkan Gram</label>\n<input type="text" id="sellGram" inputmode="decimal" placeholder="Contoh: 0.8888">\n</div>\n<div class="calc-input-group">\n<label>Rupiah (IDR) \\u21C6</label>\n<input type="text" id="sellIdr" inputmode="numeric" placeholder="isi nominal, contoh: 88.000.000">\n</div>\n</div>\n</div>\n</div>\n</div>\n<footer id="footerApp"><span class="marquee-text">&copy;2026 ~ahmadkholil~</span></footer>\n<script src="https://code.jquery.com/jquery-3.7.0.min.js"><\\/script>\n<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"><\\/script>\n<script src="https://s3.tradingview.com/tv.js"><\\/script>\n<script>\n(function(){\nvar isDark=localStorage.getItem(\'theme\')===\'dark\';\nvar lastTopRowId=\'\';\nvar messageQueue=[];\nvar isProcessing=false;\nvar latestHistory=[];\nvar isFirstRender=true;\nvar savedPriority=localStorage.getItem(\'profitPriority\');\nvar profitPriority=(savedPriority&&[\'jt10\',\'jt20\',\'jt30\',\'jt40\',\'jt50\'].indexOf(savedPriority)!==-1)?savedPriority:\'jt10\';\nvar headerLabels={\'jt10\':\'Est.cuan 10JT \\u27BA gr\',\'jt20\':\'Est.cuan 20JT \\u27BA gr\',\'jt30\':\'Est.cuan 30JT \\u27BA gr\',\'jt40\':\'Est.cuan 40JT \\u27BA gr\',\'jt50\':\'Est.cuan 50JT \\u27BA gr\'};\nvar blinkTimeout=null;\nvar latestBuyRate=0;\nvar latestSellRate=0;\nvar isCalcUpdating=false;\nfunction parseRupiahInput(str){if(!str)return 0;return parseInt(str.replace(/\\\\./g,\'\'),10)||0}\nfunction formatRupiahCalc(n){if(isNaN(n)||n===0)return\'\';return Math.round(n).toLocaleString(\'id-ID\').replace(/,/g,\'.\')}\nfunction formatRupiahLive(str){var num=str.replace(/\\\\D/g,\'\');if(!num)return\'\';return parseInt(num,10).toLocaleString(\'id-ID\').replace(/,/g,\'.\')}\nfunction parseGramInput(str){if(!str)return 0;return parseFloat(str.replace(\',\',\'.\'))||0}\nfunction formatGramCalc(n){if(isNaN(n)||n===0)return\'\';return n.toFixed(4).replace(\'.\',\',\')}\nfunction updateCalcRates(){document.getElementById(\'buyRateDisplay\').textContent=latestBuyRate?formatRupiahCalc(latestBuyRate):\'-\';document.getElementById(\'sellRateDisplay\').textContent=latestSellRate?formatRupiahCalc(latestSellRate):\'-\'}\nfunction setupCalcListeners(){var buyIdr=document.getElementById(\'buyIdr\');var buyGram=document.getElementById(\'buyGram\');var sellIdr=document.getElementById(\'sellIdr\');var sellGram=document.getElementById(\'sellGram\');function onlyNumbers(e){var key=e.key;if(e.ctrlKey||e.metaKey)return;if(key===\'Backspace\'||key===\'Delete\'||key===\'ArrowLeft\'||key===\'ArrowRight\'||key===\'Tab\')return;if(!/^[0-9]$/.test(key)){e.preventDefault()}}function onlyNumbersAndComma(e){var key=e.key;var val=this.value;if(e.ctrlKey||e.metaKey)return;if(key===\'Backspace\'||key===\'Delete\'||key===\'ArrowLeft\'||key===\'ArrowRight\'||key===\'Tab\')return;if(key===\',\'||key===\'.\'){if(val.indexOf(\',\')!==-1||val.indexOf(\'.\')!==-1){e.preventDefault();return}return}if(!/^[0-9]$/.test(key)){e.preventDefault()}}buyIdr.addEventListener(\'keypress\',onlyNumbers);sellIdr.addEventListener(\'keypress\',onlyNumbers);buyGram.addEventListener(\'keypress\',onlyNumbersAndComma);sellGram.addEventListener(\'keypress\',onlyNumbersAndComma);buyIdr.addEventListener(\'input\',function(){if(isCalcUpdating)return;isCalcUpdating=true;var cursorPos=this.selectionStart;var oldLen=this.value.length;var formatted=formatRupiahLive(this.value);this.value=formatted;var newLen=formatted.length;var newPos=cursorPos+(newLen-oldLen);if(newPos<0)newPos=0;if(newPos>newLen)newPos=newLen;this.setSelectionRange(newPos,newPos);if(latestBuyRate){var val=parseRupiahInput(formatted);var gram=val/latestBuyRate;buyGram.value=gram>0?formatGramCalc(gram):\'\'}isCalcUpdating=false});buyGram.addEventListener(\'input\',function(){if(isCalcUpdating||!latestBuyRate)return;isCalcUpdating=true;var gram=parseGramInput(this.value);var idr=gram*latestBuyRate;buyIdr.value=idr>0?formatRupiahCalc(idr):\'\';isCalcUpdating=false});sellGram.addEventListener(\'input\',function(){if(isCalcUpdating||!latestSellRate)return;isCalcUpdating=true;var gram=parseGramInput(this.value);var idr=gram*latestSellRate;sellIdr.value=idr>0?formatRupiahCalc(idr):\'\';isCalcUpdating=false});sellIdr.addEventListener(\'input\',function(){if(isCalcUpdating)return;isCalcUpdating=true;var cursorPos=this.selectionStart;var oldLen=this.value.length;var formatted=formatRupiahLive(this.value);this.value=formatted;var newLen=formatted.length;var newPos=cursorPos+(newLen-oldLen);if(newPos<0)newPos=0;if(newPos>newLen)newPos=newLen;this.setSelectionRange(newPos,newPos);if(latestSellRate){var val=parseRupiahInput(formatted);var gram=val/latestSellRate;sellGram.value=gram>0?formatGramCalc(gram):\'\'}isCalcUpdating=false})}\nsetupCalcListeners();\nfunction getOrderedProfitKeys(){var all=[\'jt10\',\'jt20\',\'jt30\',\'jt40\',\'jt50\'];var result=[profitPriority];all.forEach(function(k){if(k!==profitPriority)result.push(k)});return result}\nfunction updateTableHeaders(){var keys=getOrderedProfitKeys();$(\'#thP1\').text(headerLabels[keys[0]]);$(\'#thP2\').text(headerLabels[keys[1]]);$(\'#thP3\').text(headerLabels[keys[2]]);$(\'#thP4\').text(headerLabels[keys[3]]);$(\'#thP5\').text(headerLabels[keys[4]])}\nfunction createTradingViewWidget(){var wrapper=document.getElementById(\'tradingview_chart\');var h=wrapper.offsetHeight||370;new TradingView.widget({width:"100%",height:h,symbol:"OANDA:XAUUSD",interval:"15",timezone:"Asia/Jakarta",theme:isDark?\'dark\':\'light\',style:"1",locale:"id",toolbar_bg:"#f1f3f6",enable_publishing:false,hide_top_toolbar:false,save_image:false,container_id:"tradingview_chart"})}\nvar table=$(\'#tabel\').DataTable({pageLength:4,lengthMenu:[4,8,18,48,88,888,1441],order:[],deferRender:true,dom:\'<"dt-top-controls"lf>t<"bottom"p><"clear">\',columns:[{data:"waktu",className:"waktu"},{data:"transaction",className:"transaksi"},{data:"p1",className:"profit"},{data:"p2",className:"profit"},{data:"p3",className:"profit"},{data:"p4",className:"profit"},{data:"p5",className:"profit"}],language:{emptyTable:"Menunggu data harga emas dari Treasury...",zeroRecords:"Tidak ada data yang cocok",lengthMenu:"Lihat _MENU_",search:"Cari:",paginate:{first:"\\u00ab",previous:"Kembali",next:"Lanjut",last:"\\u00bb"}},initComplete:function(){var filterDiv=$(\'.dataTables_filter\');var activeVal=profitPriority.replace(\'jt\',\'\');var profitBtns=$(\'<div class="profit-order-btns" id="profitOrderBtns"><button class="profit-btn\'+(activeVal===\'10\'?\' active\':\'\')+\'" data-val="10">10</button><button class="profit-btn\'+(activeVal===\'20\'?\' active\':\'\')+\'" data-val="20">20</button><button class="profit-btn\'+(activeVal===\'30\'?\' active\':\'\')+\'" data-val="30">30</button><button class="profit-btn\'+(activeVal===\'40\'?\' active\':\'\')+\'" data-val="40">40</button><button class="profit-btn\'+(activeVal===\'50\'?\' active\':\'\')+\'" data-val="50">50</button></div>\');filterDiv.wrap(\'<div class="filter-wrap"></div>\');filterDiv.before(profitBtns);$(\'#profitOrderBtns\').on(\'click\',\'.profit-btn\',function(){var val=$(this).data(\'val\');profitPriority=\'jt\'+val;localStorage.setItem(\'profitPriority\',profitPriority);$(\'#profitOrderBtns .profit-btn\').removeClass(\'active\');$(this).addClass(\'active\');if(latestHistory.length){renderTable()}});updateTableHeaders()}});\nfunction getTopRowId(h){if(!h||!h.length)return\'\';var sorted=h.slice().sort(function(a,b){return new Date(b.created_at)-new Date(a.created_at)});return sorted[0].created_at+\'|\'+sorted[0].buying_rate}\nfunction triggerBlinkEffect(){if(blinkTimeout){clearTimeout(blinkTimeout)}var firstRow=$(\'#tabel tbody tr:first-child\');if(!firstRow.length)return;firstRow.removeClass(\'blink-row\');void firstRow[0].offsetWidth;firstRow.addClass(\'blink-row\');blinkTimeout=setTimeout(function(){firstRow.removeClass(\'blink-row\');blinkTimeout=null},2000)}\nfunction renderTable(){var h=latestHistory;if(!h||!h.length)return;var newTopRowId=getTopRowId(h);var isNewData=newTopRowId!==lastTopRowId;if(isNewData){lastTopRowId=newTopRowId}h.sort(function(a,b){return new Date(b.created_at)-new Date(a.created_at)});var keys=getOrderedProfitKeys();updateTableHeaders();var arr=h.map(function(d){return{waktu:d.waktu_display,transaction:\'Beli: \'+d.buying_rate+\' Jual: \'+d.selling_rate+\'<br>\'+d.diff_display,p1:d[keys[0]],p2:d[keys[1]],p3:d[keys[2]],p4:d[keys[3]],p5:d[keys[4]]}});table.clear().rows.add(arr).draw(false);table.page(\'first\').draw(false);if(isNewData&&!isFirstRender){setTimeout(function(){triggerBlinkEffect()},50)}if(isFirstRender){isFirstRender=false}}\nfunction updateTable(h){if(!h||!h.length)return;latestHistory=h;h.sort(function(a,b){return new Date(b.created_at)-new Date(a.created_at)});if(h.length>0&&h[0].buying_rate_raw&&h[0].selling_rate_raw){latestBuyRate=h[0].buying_rate_raw;latestSellRate=h[0].selling_rate_raw;updateCalcRates()}renderTable()}\nfunction updateUsd(h){var c=document.getElementById("currentPrice"),p=document.getElementById("priceList");if(!h||!h.length){c.textContent="Menunggu data...";c.className="loading-text";p.innerHTML=\'<li class="loading-text">Menunggu data...</li>\';return}c.className="";function prs(s){return parseFloat(s.trim().replace(/\\\\./g,\'\').replace(\',\',\'.\'))}var r=h.slice().reverse();var icon="\\u2796";if(r.length>1){var n=prs(r[0].price),pr=prs(r[1].price);icon=n>pr?"\\u{1F680}":n<pr?"\\u{1F53B}":"\\u2796"}c.innerHTML=r[0].price+" "+icon;var html=\'\';for(var i=0;i<r.length;i++){var ic="\\u2796";if(i===0&&r.length>1){var nn=prs(r[0].price),pp=prs(r[1].price);ic=nn>pp?"\\u{1F7E2}":nn<pp?"\\u{1F534}":"\\u2796"}else if(i<r.length-1){var nn=prs(r[i].price),nx=prs(r[i+1].price);ic=nn>nx?"\\u{1F7E2}":nn<nx?"\\u{1F534}":"\\u2796"}else if(r.length>1){var nn=prs(r[i].price),pp=prs(r[i-1].price);ic=nn<pp?"\\u{1F534}":nn>pp?"\\u{1F7E2}":"\\u2796"}html+=\'<li>\'+r[i].price+\' <span class="time">(\'+r[i].time+\')</span> \'+ic+\'</li>\'}p.innerHTML=html}\nfunction updateLimit(val){document.getElementById(\'limitBulan\').textContent=val}\nfunction processMessage(d){if(d.ping||d.pong)return;if(d.history)updateTable(d.history);if(d.usd_idr_history)updateUsd(d.usd_idr_history);if(d.limit_bulan!==undefined)updateLimit(d.limit_bulan)}\nfunction processQueue(){if(isProcessing||!messageQueue.length)return;isProcessing=true;var msg=messageQueue.shift();try{processMessage(msg)}catch(e){}isProcessing=false;if(messageQueue.length)requestAnimationFrame(processQueue)}\nvar ws,ra=0,pingInterval;\nfunction conn(){var pr=location.protocol==="https:"?"wss:":"ws:";ws=new WebSocket(pr+"//"+location.host+"/ws");ws.onopen=function(){ra=0;if(pingInterval)clearInterval(pingInterval);pingInterval=setInterval(function(){if(ws&&ws.readyState===1)try{ws.send(\'ping\')}catch(e){}},25000)};ws.onmessage=function(e){try{var d=JSON.parse(e.data);messageQueue.push(d);requestAnimationFrame(processQueue)}catch(x){}};ws.onclose=function(){if(pingInterval)clearInterval(pingInterval);ra++;setTimeout(conn,Math.min(1000*Math.pow(1.3,ra-1),15000))};ws.onerror=function(){}}\nconn();\nfunction updateJam(){var n=new Date();var days=[\'Minggu\',\'Senin\',\'Selasa\',\'Rabu\',\'Kamis\',\'Jumat\',\'Sabtu\'];var hari=days[n.getDay()];var jam=n.toLocaleTimeString(\'id-ID\',{hour12:false});document.getElementById("jam").textContent=hari+", "+jam+" WIB"}\nsetInterval(updateJam,1000);updateJam();\nwindow.toggleTheme=function(){var b=document.body,btn=document.getElementById(\'themeBtn\');b.classList.toggle(\'dark-mode\');isDark=b.classList.contains(\'dark-mode\');btn.textContent=isDark?"\\u2600\\uFE0F":"\\u{1F319}";localStorage.setItem(\'theme\',isDark?\'dark\':\'light\');document.getElementById(\'tradingview_chart\').innerHTML=\'\';createTradingViewWidget()};\nif(localStorage.getItem(\'theme\')===\'dark\'){document.body.classList.add(\'dark-mode\');document.getElementById(\'themeBtn\').textContent="\\u2600\\uFE0F"}\nsetTimeout(createTradingViewWidget,100);\n})();\n<\\/script>\n</body>\n</html>';
